


ブラウザ→サーバー→DB





■サイト閲覧時の流れ説明

　　　・ブラウザにURL打つ

　　　・ブラウザがURLに対応するIPを取得

　　　・URLのIPに対して、HTTPリクエストというものを投げる
　　　　HTTPリクエストはブラウザが仕様に乗っ取った形式で作る。
　　　　実際の通信処理はOSに依頼

　　　　※HTTPリクエストとは

　　　　リクエストを受け取る側はHttpサーバーやWebサーバーなどと呼ばれる。

　　　　※そもそもサーバーとは


　　　・サーバー側はリクエスト内容に応じてHTTPレスポンスを返す。
　　　　画面を表示する場合、HTTPレスポンスに乗せてHtmlという形式のファイルを返す。

　　　　リクエストの内容によっては、DBからデータを取得してそれをもとにHTMLを作成する。
　　　　（例えばログインユーザーの会員情報を表示するページなど）

　　　　WebサーバーはDBからSQLという言語を用いてデータを取得・登録する。

　　　　※DBとの接続方法
　　　　※SQLについて

　　　　※HTMLについて

　　　　・HTMLに関連するcss、javascriptのファイルも返す。

　　　　※HTML、css、javascriptの概要説明

　　　・ブラウザは受け取ったHTML、cssを解析し、画面を描画する
　　　　html、css、jsの文法・仕様は仕様を策定する団体によって定義されており、主要なブラウザはその仕様に従っている。
　　　　そのため、異なるブラウザで表示しても同じ画面が表示される。
　　　　（差異がある場合もあるが。。IE11など）

　　　　（重要度低）入力と出力が定義されているだけど、実際の実装はブラウザによリ異なる。
　　　　→ブラウザによってパフォーマンス変わる原因
　　　

　　　※HTML、css、javascriptの例
　　　


　　　
■個別


・サーバーとは？  
　　・役割の事

   Webサーバ専用の特別なコンピュータではありません。
   WebサーバをWebサーバたらしめているのは「Webサーバのソフト」なのです。
   普通のコンピュータにWebサーバのソフトを入れることによって、Webサーバとしてのお仕事ができるコンピュータになります。
   https://wa3.i-3-i.info/word12466.html

　　・サーバーアプリの動作イメージ
　　　　・プロセスがポートを見てる
　　　　・ポートに来たリクエストをアプリが感知
　　　　・感知した後の動作はアプリによる

　　　　・Webサーバーの場合
　　　　　　・URLに対応したファイルを返却

　　　　・アプリサーバーの場合
　　　　　　・URLに対応したプログラムを呼び出し→結果を返却

　　・ブレードサーバーなどはサーバー向けの用途に特化したもの
　　　LANケーブルのポート数が多い
　　　メモリやCPUを増やしやすい
　　　文脈によってはハード的な意味にもなる




　　・開発時によく出てくるサーバー
　　　　・Webサーバー
　　　　　
　　　　　静的ファイルを返す（ヘルプページなど）
　　　　　SSLの処理なども行う。　
　　　　　Javaなどのプログラムを動かすことは出来ない（プラグイン使えば出来るかもだが機能が貧弱）

　　　　　nginx、Apache HTTP Server、IIS

　　　　　ただ、実際には動的にページを作ることが多い。
　　　　　マイページなど。ログインしているユーザーによって内容が変わる。（例の画面を出す）

　　　　　DBから情報を取得し、動的にHTMLなどを作って返す必要がある
　　　　　→javaなどのプログラムで実装

　　　　　
　　　　　javaなどのプログラムを動かせるサーバーアプリが必要
　　　　　→Appサーバー
　　　　　

　　　　・Appサーバー
         HTTPリクエストを受け取り、プログラムに受け渡し、プログラムから出力された結果を返却する機能を持つ。
　　　　　プログラムはJavaなどの言語で作成する。
         動的にHTMLページなどを作る際に利用。
         言語によっていろいろな種類がある。

         言語ごとのアプリサーバーの例を表示
         「Tomcat」「Glass Fish」「IIS」

         そのサーバーアプリに対応する言語でかかれたプログラムを動かすことが出来る。
         ただ、どんなプログラムでも動かせるわけではなく、そのAppサーバーが求める仕様に乗っ取って作られたアプリである必要がある。
         例えばJavaなら言語の開発元が策定したサーブレットの仕様があり、大半のAppサーバーアプリはその形式を想定している。
         
         サーブレットの仕様の例
         https://www.cresc.co.jp/tech/java/Servlet_Specifications/servlet_3-0_about.htm

         こういうメソッドがあってこういうルールで呼ばれるなどが定義されていることを示す。

         その他の言語の仕様も表示
         ASP.netなど

         図
         Tomcat   プログラム(Javaでサーブレット仕様にのっとったもの)←ここを開発する。

        
         （受け渡し方は言語やアプリサーバが準拠するサーバー側の実装の仕様による。javaでいうサーブレット）
         例を表示
         こういうルールを定義するとURLとプログラムが紐付けられる的な


         Webサーバーとの違い
         Httpリクエストを受け付けることは出来るが、最低限の機能しかない。
         WebサーバーにあるようなSSLの対応やリクエスト・レスポンスの変更機能などは基本ない。


         対応表
         　　　　　　　Http関連の機能　　動的ページ作成　　　　　　　　　　　　　　　静的コンテンツ配置
         Webサーバ　　豊富　　　　　　　　不可
         　　　　　　　　　　　　　　　　（言語によってはプラグインで可能）　　　　　　可能
         
         Appサーバ　　最低限　　　　　　　可能
         　　　　　　　　　　　　　　　　（そのAppサーバーアプリが対応する言語なら）　　可能






　　　　・WebサーバーとAppサーバーの使い分け
　　　　　→両方使うことが多い

　　　　　nginx →　tomcat

         nginxでsslの処理などを行い、tomcatに転送

         tomcatはnginxで使ってるポートは使えないので8080などの適当なポートを使う。
         

         Tomcat、IIS

         J2ee参考
         https://thinkit.co.jp/free/article/0708/2/2


　　　　　IISのように、特定の言語(.NET系)に対してはWebサーバーとAppサーバー両方の機能を持つものもある。

   
         ・標準のフレームワークだと上長になりがちなので、記述を楽にするためのライブラリを使うことが多い。

         　例）Spring、ASP .NET MVC
　　　　　
          コード例



　　　　・DBサーバー
　　　　　データベースアプリを稼働させる。　
　　　　　特定のポートをリッスン。

　　　　　アプリケーションから利用する。
　　　　　接続用のライブラリを使う。（コード例）

　　　　　



・ブラウザ ⇔ Httpサーバー仕組み

　　・HTTPリクエスト

　　・HTTPレスポンス

　　・HTML

　　・CSS

　　・Javascript




・Httpサーバー ⇔ DBサーバーの仕組み

   ・DBとのコネクションを貼る
   →各DBベンダーが公開しているライブラリを使用。
   接続文字列を投げればその中でよろしくやってくれる。

　 ・SQLを投げる
　　→これもライブラリで出来る。
　　　もしくは言語としてそういった仕組みが用意されている


　　→ただし、そのまま使うと冗長な記述になりがち

　　→楽に書くためのライブラリを使用（ORマッパーと呼ばれる）

　　→コードのサンプル
   　





・サーバー
https://wa3.i-3-i.info/word144.html


・tomcat
https://wa3.i-3-i.info/word12843.html
https://thinkit.co.jp/free/article/0708/2/1
https://agency-star.co.jp/column/tomcat


・アプリケーションサーバー

https://www.otsuka-shokai.co.jp/words/application-server.html

アプリケーションサーバーにはアプリケーションプログラムによって以下のような種類がある。
（1）Java：「Tomcat」「Glass Fish」
（2）PHP：「Apache」
（3）Ruby：「Unicorn」「Thin」「Rainbows」「Puma」

マイクロソフトのIIS（Internet Information Services）はWebサーバーとアプリケーションサーバーの機能を統合しVisual Basic、C#などの言語で記述したプログラムが作動している。

Appサーバーをwebサーバーとして利用しない理由
https://qiita.com/yCroma/items/e46476e2ac7c372bb2a3

2015年Webサーバアーキテクチャ序論
https://blog.yuuk.io/entry/2015-webserver-architecture



・ブラウザ周りの仕様
https://qiita.com/megmogmog1965/items/e180d02be711cecdc038
